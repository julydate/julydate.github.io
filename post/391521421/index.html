<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/favicon.ico"><link rel="icon" type="image/png" href="/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="author" content="七夏浅笑"><meta name="description" content="Nginx 11月6日的安全更新中，修补了三个可导致拒绝服务的漏洞：CVE-2018-16843,CVE-2018-16844和CVE-2018-16845。位于Nginx HTTP/2 模块和流媒体MP4模块。基于Nginx的Tengine也受到了影响，并于2018年11月11日发布更新版本 Tengine-2.2.3 修复了该漏洞。只为了修复漏洞的话可以只看本文「编译升级到Tengine-2."><meta name="keywords" content="笔记,"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><title>CentOS宝塔面板Tengine手动升级到 v2.2.3 修复 HTTP/2 安全问题 并开启TLSv1.3 - 七夏浅笑</title><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css"><link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css"><link rel="stylesheet" href="/lib/prettify/tranquil-heart.min.css"><link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css"><link rel="stylesheet" href="/css/main.css"><script src="/lib/jquery/jquery.min.js"></script><style type="text/css">.banner-bg{background-image:url(//julydate-1251438221.file.myqcloud.com/img/bg.jpg);background-position:center;background-repeat:repeat-y;background-size:cover;background-attachment:fixed}</style><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="七夏浅笑" type="application/atom+xml">
</head><body class="banner-bg"><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>七夏浅笑</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/">主页</a></li><li class="nav-item"><a class="nav-link" href="/archives/">归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/">分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a></li><li class="nav-item"><a class="nav-link" href="/links/">友链</a></li><li class="nav-item"><a class="nav-link" href="/about/">关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a></li></ul></div></div></nav><div class="view intro-2 rgba-black-slight" id="background"><div class="full-bg-img"><div class="mask flex-center"><div class="container text-center white-text fadeInUp"><span class="h2" id="subtitle"></span><br><p class="mt-3"><i class="far fa-calendar-alt"></i> <span class="post-date">2018-11-18&nbsp;|&nbsp;</span> <i class="far fa-chart-bar"></i> <span class="post-count">2.7k</span>字&nbsp;|&nbsp; <i class="far fa-clock"></i> <span class="post-count">12</span>分钟</p></div></div></div></div></header><main id="mainContent" class="rgba-black-slight"><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="py-5 z-depth-3" id="board"><div class="post-content mx-auto" id="post"><div class="markdown-body"><p>Nginx 11月6日的安全更新中，修补了三个可导致拒绝服务的漏洞：CVE-2018-16843,CVE-2018-16844和CVE-2018-16845。位于Nginx HTTP/2 模块和流媒体MP4模块。基于Nginx的Tengine也受到了影响，并于2018年11月11日发布更新版本 Tengine-2.2.3 <a target="_blank" href="https://www.oschina.net/news/101724/tengine-2-2-3-released" rel="external nofollow noreferrer noopener">修复了该漏洞</a>。只为了修复漏洞的话可以只看本文「编译升级到Tengine-2.2.3」部分。</p><span id="more"></span><h2 id="关于本次漏洞的相关信息"><a href="#关于本次漏洞的相关信息" class="headerlink" title="关于本次漏洞的相关信息"></a>关于本次漏洞的相关信息</h2><p>一共有三个可导致拒绝服务的漏洞，影响绝大部分Nginx版本：</p><blockquote><p>CVE-2018-16843,CVE-2018-16844漏洞存在于ngx_http_v2模块之中(默认情况下不编译，编译时需要开启–with-http_v2_module，同时将listen http2添加到配置文件中)，当用户添加http2支持时，攻击者可以发送特制的HTTP/2请求，消耗CPU和内存资源，最终导致DoS。</p><p>CVE-2018-16845漏洞存在于ngx_http_mp4_module模块中，当用户对Nginx添加MP4流媒体支持，恶意的MP4文件会导致处理进程无限循环、崩溃或者内存泄露。</p><p>总的来说，HTTP/2 漏洞影响 1.9.5 和 1.15.5 之间的所有 nginx 版本，MP4 模块安全问题影响运行 nginx 1.0.7, 1.1.3 及更高版本的服务器。*<a target="_blank" href="https://cert.360.cn/warning/detail?id=7145d4cac6db4b7ca609990ad8a71f83" rel="external nofollow noreferrer noopener">更多详细信息</a>*</p></blockquote><p>目前宝塔面板内的Tengine还没有更新，依然是v2.2.2版本，所以打算手动编译升级到Tengine-2.2.3，然后竟然打算重新编译升级Tengine的话，打算顺便把TLSv1.3也给弄上，关于为什么宝塔官方没有直接在面板上支持TLSv1.3开启以及升级OpenSSL的影响有如下说明：</p><blockquote><p>关于openssl，你要支持tls1.3就必须用nginx mainline版，而且换成openssl-1.1.0f/g/openssl-1.1.1等版本 那么php7.0以下的Php版本都编译不上 mariadb10.0/10.1编译不上，而我们所做的rpm包用的openssl版本还是1.0.2k的，若要升级至openssl-1.1.1,则要花费大量时间重新编译rpm包，同时还要考虑之前安装过的宝塔的兼容问题。</p><p>如果你能给我一套方案让几十万的宝塔使用用户可以完美升级的方案，或者给我找几十万需要Tls1.3的用户的话，我也很乐意去升级的。</p><p>作为开发人员，我也很想让面板支持所有新功能/新特性，但1是人手不足，很多东西想弄来不及弄出来，2是新功能就意味着可能会有新的漏洞/BUG，让几十万用户遭受，我们承受不起。*<a target="_blank" href="https://www.bt.cn/bbs/thread-11560-1-1.html" rel="external nofollow noreferrer noopener">引用自宝塔官方论坛</a>*</p></blockquote><p>因为我那台服务器上没有用到PHP7.0以下的版本，也没有使用mariadb10.0/10.1，所以我打算直接把OpenSSL升级到1.1.1版本并开启TLSv1.3</p><h2 id="升级OpenSSL"><a href="#升级OpenSSL" class="headerlink" title="升级OpenSSL"></a>升级OpenSSL</h2><blockquote><p>下载openssl-1.1.1</p></blockquote><p><code>wget https://www.openssl.org/source/openssl-1.1.1.tar.gz</code><br>最新版OpenSSL可以在官网 <a target="_blank" href="https://www.openssl.org/source/" rel="external nofollow noreferrer noopener">https://www.openssl.org/source/</a> 看到。</p><blockquote><p>编译升级OpenSSL</p></blockquote><pre><code class="bash">tar -xvf openssl-1.1.1.tar.gz
rm -f openssl-1.1.1.tar.gz
cd openssl-1.1.1
./config --prefix=/usr shared zlib-dynamic
rm -f /usr/include/openssl
make &amp;&amp; make install
ln -sf /usr/include/openssl/*.h /usr/include/
ln -sf /usr/lib64/openssl/engines/*.so /usr/lib/
ldconfig -v
echo -e &quot;openssl_installed&quot; &gt;&gt; /www/server/lib.pl
</code></pre><p><strong>注意：</strong> <code>ln -sf /usr/lib64/openssl/engines/*.so /usr/lib/</code> 这一步，可能因为宝塔版本原因，OpenSSL的位置可能不同，例如可能位于 <code>/usr/lib/openssl/engines/</code> ，通过 <code>find / -name openssl</code> 命令可以查看位置：</p><pre><code class="shell">[root@ggc ~]# find / -name openssl
/usr/local/openssl
/usr/local/openssl/include/openssl
/usr/local/openssl/bin/openssl
/usr/share/doc/openssl
/usr/lib64/openssl
/usr/lib64/python2.7/site-packages/cryptography/hazmat/bindings/openssl
/usr/lib64/python2.7/site-packages/cryptography/hazmat/backends/openssl
/usr/include/openssl
/usr/bin/openssl
/root/tengine-2.2.3/auto/lib/openssl
/root/openssl-1.1.1/test/ossl_shim/include/openssl
/root/openssl-1.1.1/include/openssl
/root/openssl-1.1.1/apps/openssl
/www/server/php/72/src/ext/openssl
/www/server/nginx/src/auto/lib/openssl
/www/server/nginx/src/openssl
/etc/pki/ca-trust/extracted/openssl
</code></pre><blockquote><p>升级完过后查看一下OpenSSL版本是否正确</p></blockquote><p><code>openssl version</code></p><h2 id="升级curl"><a href="#升级curl" class="headerlink" title="升级curl"></a>升级curl</h2><blockquote><p>添加一个新的repo</p></blockquote><p><code>vim /etc/yum.repos.d/city-fan.repo</code></p><blockquote><p>在里面添加内容：</p></blockquote><pre><code class="shell">[CityFan]
name=City Fan Repo
baseurl=http://www.city-fan.org/ftp/contrib/yum-repo/rhel$releasever/$basearch/
enabled=1
gpgcheck=0
</code></pre><p><strong>注意：</strong>下一步 <code>yum install libcurl</code> 报错提示repo仓库 <a target="_blank" href="http://www.city-fan.org/ftp/contrib/yum-repo/" rel="external nofollow noreferrer noopener">http://www.city-fan.org/ftp/contrib/yum-repo/</a> 不可用的话，自己搜索一下能用的仓库替换就好啦。</p><blockquote><p>升级curl</p></blockquote><pre><code class="bash">yum clean all
yum install libcurl
</code></pre><h2 id="编译升级到Tengine-2-2-3"><a href="#编译升级到Tengine-2-2-3" class="headerlink" title="编译升级到Tengine-2.2.3"></a>编译升级到Tengine-2.2.3</h2><blockquote><p>获得宝塔Tengine的编译参数</p></blockquote><p><code>nginx -V</code> 结果如下：</p><pre><code class="shell">[root@ggc ~]# nginx -V
Tengine version: Tengine/2.2.2 (nginx/1.8.1)
built by gcc 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) 
TLS SNI support enabled
configure arguments: --user=www --group=www --prefix=/www/server/nginx --add-module=/www/server/nginx/src/ngx_devel_kit --add-module=/www/server/nginx/src/lua_nginx_module --add-module=/www/server/nginx/src/ngx_cache_purge --add-module=/www/server/nginx/src/nginx-sticky-module --with-http_stub_status_module --with-http_ssl_module --with-http_v2_module --with-http_image_filter_module --with-http_gzip_static_module --with-http_gunzip_module --with-ipv6 --with-http_sub_module --with-http_flv_module --with-http_addition_module --with-http_realip_module --with-http_mp4_module --with-http_concat_module --with-ld-opt=-Wl,-E --without-http_upstream_session_sticky_module --with-pcre=pcre-8.40
nginx: loaded modules:
nginx:     ngx_core_module (static)
nginx:     ngx_errlog_module (static)
nginx:     ngx_conf_module (static)
nginx:     ngx_dso_module (static)
......
</code></pre><p>可以看出他它的版本号和配置文件路径和添加的模块路径都在 /www/server 下, 其中 /www 是宝塔默认安装路径，server 则是宝塔存服务端和配置文件的路径，于是确定了这是宝塔的 nginx，将 configure arguments: 后面的参数复制下来，后面需要用到：</p><blockquote><p>–user=www –group=www –prefix=/www/server/nginx –add-module=/www/server/nginx/src/ngx_devel_kit –add-module=/www/server/nginx/src/lua_nginx_module –add-module=/www/server/nginx/src/ngx_cache_purge –add-module=/www/server/nginx/src/nginx-sticky-module –with-http_stub_status_module –with-http_ssl_module –with-http_v2_module –with-http_image_filter_module –with-http_gzip_static_module –with-http_gunzip_module –with-ipv6 –with-http_sub_module –with-http_flv_module –with-http_addition_module –with-http_realip_module –with-http_mp4_module –with-http_concat_module –with-ld-opt=-Wl,-E –without-http_upstream_session_sticky_module <font color="#ff0000">–with-pcre=pcre-8.40</font></p></blockquote><p><strong>注意：</strong>红色部分的 <code>--with-pcre=pcre-8.40</code> 需要修改成你自己的路径，比如 <code>--with-pcre=/www/server/nginx/src/pcre-8.40</code> ，和前面寻找OpenSSL目录一样，通过 <code>find / -name &#39;pcre-8.40&#39;</code> 命令搜寻。</p><blockquote><p>下载Tengine-2.2.3并编译</p></blockquote><pre><code class="bash">wget https://tengine.taobao.org/download/tengine-2.2.3.tar.gz
tar -xvf tengine-2.2.3.tar.gz
rm -f tengine-2.2.3.tar.gz
cd nginx-1.13.3
./configure --user=www --group=www --prefix=/www/server/nginx --add-module=/www/server/nginx/src/ngx_devel_kit --add-module=/www/server/nginx/src/lua_nginx_module --add-module=/www/server/nginx/src/ngx_cache_purge --add-module=/www/server/nginx/src/nginx-sticky-module --with-http_stub_status_module --with-http_ssl_module --with-http_v2_module --with-http_image_filter_module --with-http_gzip_static_module --with-http_gunzip_module --with-ipv6 --with-http_sub_module --with-http_flv_module --with-http_addition_module --with-http_realip_module --with-http_mp4_module --with-http_concat_module --with-ld-opt=-Wl,-E --without-http_upstream_session_sticky_module --with-pcre=/www/server/nginx/src/pcre-8.40
make
</code></pre><p><strong>注意：</strong>其中 ./configure 后面那一串就是刚刚复制并修改过后的 configure arguments: 后面的参数 (请复制并修改你自己的那一段参数)；运行 ./configure 之后可能会有 ipv6 的警告， 可以不用理会， <code>make</code> 命令可以换成 <code>make -j 2</code> 代表同时使用 2 线程编译， 根据自己 cpu 核数调节， 如果中途报错，按 ctrl+c 停止编译， 然后直接 make 编译。</p><blockquote><p>寻找宝塔的Tengine所在位置并替换安装</p></blockquote><p>需要注意, <strong>不要直接</strong> <code>make install</code> ，这样可能会覆盖一些配置文件, 先通过 <code>find / -name nginx</code> 查找当前服务器里名为 nginx 的文件或目录。</p><pre><code class="shell">[root@ggc ~]# find / -name nginx
/usr/local/nginx
/usr/bin/nginx
/root/tengine-2.2.3/objs/nginx
/www/server/panel/vhost/nginx
/www/server/panel/rewrite/nginx
/www/server/nginx
/www/server/nginx/sbin/nginx
/www/server/nginx/src/objs/nginx
/etc/rc.d/init.d/nginx
</code></pre><p>可以看到在 /www/server 目录里有几个叫 nginx 的文件或目录, 其中最可疑的就是 /www/server/nginx/sbin/nginx ，直接执行 <code>/www/server/nginx/sbin/nginx -V</code> 可以看到 nginx 的版本和参数都和宝塔 Tengine 的一样，可以确定这就是宝塔的 Tengine.<br>在宝塔面板上将 Tengine 停止，确认停止后再使用 cp 命令将编译好的新版本覆盖掉宝塔的 nginx，否则可能会提示文件正在占用，覆盖前建议先把旧的Tengine给备份一下。</p><pre><code class="bash">rm -f /www/server/nginx/sbin/nginx.old
mv /www/server/nginx/sbin/nginx /www/server/nginx/sbin/nginx.old
cp objs/nginx /www/server/nginx/sbin/nginx
</code></pre><p>替换成功后使用 <code>nginx -V</code> 命令可以看到 Tengine 已经成功升级到了2.2.3</p><pre><code class="shell">[root@ggc ~]# nginx -V
Tengine version: Tengine/2.2.3 (nginx/1.8.1)
built by gcc 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) 
TLS SNI support enabled
configure arguments: --user=www --group=www --prefix=/www/server/nginx --add-module=/www/server/nginx/src/ngx_devel_kit --add-module=/www/server/nginx/src/lua_nginx_module --add-module=/www/server/nginx/src/ngx_cache_purge --add-module=/www/server/nginx/src/nginx-sticky-module --with-http_stub_status_module --with-http_ssl_module --with-http_v2_module --with-http_image_filter_module --with-http_gzip_static_module --with-http_gunzip_module --with-ipv6 --with-http_sub_module --with-http_flv_module --with-http_addition_module --with-http_realip_module --with-http_mp4_module --with-http_concat_module --with-ld-opt=-Wl,-E --without-http_upstream_session_sticky_module --with-pcre=/www/server/nginx/src/pcre-8.40
nginx: loaded modules:
nginx:     ngx_core_module (static)
nginx:     ngx_errlog_module (static)
nginx:     ngx_conf_module (static)
nginx:     ngx_dso_module (static)
......
</code></pre><p>在宝塔面板上重新开启 Tengine ，启动成功就好啦。</p><h2 id="开启TLSv1-3并关闭TLSv1-0"><a href="#开启TLSv1-3并关闭TLSv1-0" class="headerlink" title="开启TLSv1.3并关闭TLSv1.0"></a>开启TLSv1.3并关闭TLSv1.0</h2><p>如图所示，打开宝塔面板的站点设置选型卡，在 ssl_protocols 后面加 TLSv1.3 ，可以选择删除 TLSv1（图中已删除），因为 TLSv1.0 不符合 PCI DSS 规范。然后将 ssl_ciphers 后面修改为：<br><code>TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+ECDSA+AES128:EECDH+aRSA+AES128:RSA+AES128:EECDH+ECDSA+AES256:EECDH+aRSA+AES256:RSA+AES256:EECDH+ECDSA+3DES:EECDH+aRSA+3DES:RSA+3DES:!MD5;</code></p><p><img src="//julydate-1251438221.file.myqcloud.com/assets/img/bt_switch_to_tls1.3.jpg" srcset="/img/loading.gif" alt="p1"></p><p>保存成功过后，使用 <a target="_blank" href="https://myssl.com/" rel="external nofollow noreferrer noopener">https://myssl.com</a> 就可以查看 TLSv1.3 是否配置成功以及其他的SSL信息了喵。</p><p><img src="//julydate-1251438221.file.myqcloud.com/assets/img/check_tls_by_myssl.jpg" srcset="/img/loading.gif" alt="p1"></p><p><strong>注意：</strong>同一台服务器下所有站点设置里面的 TLSv1.3 需要全部都配置上，不能单独只设置一个站点，同理，要关闭 TLSv1.0 也需要同时修改所有站点的站点设置里面的 ssl_protocols 参数，原因如下：</p><blockquote><p>ssl_protocols 这个指令只在默认 server 中生效，在同一个 IP 的其他 server 块并不生效，比如有这样的需求：两个域名一个开启 TLSv1.3，另一个不开启 TLSv1.3，目前开源 tengine 和 nginx 是做不到的。*<a target="_blank" href="https://yq.aliyun.com/articles/632491" rel="external nofollow noreferrer noopener">关于 TLSv1.3 的更多详细信息</a>*</p></blockquote><p>从这可以看到，这点也有其他人踩坑：<a target="_blank" href="https://www.hostloc.com/thread-466767-1-1.html" rel="external nofollow noreferrer noopener">宝塔nginx关闭不了tlsv1.0</a> (我不管，反正我最开始就没注意到qwq，弄了半天没找到问题。</p><blockquote><p>参考文章：<br>· <a target="_blank" href="https://resdon.cn/article/bt-tls1-3.html" rel="external nofollow noreferrer noopener">使用宝塔面板开启TLSv1.3</a> by resdon<br>· <a target="_blank" href="https://www.cjbase.cn/archives/100/" rel="external nofollow noreferrer noopener">宝塔手动升级Nginx，开启TLS1.3 final</a> by Sagit<br>· <a target="_blank" href="https://blog.ni-co.moe/public/527.html" rel="external nofollow noreferrer noopener">将宝塔面板的 nginx 升级到 1.13.3</a> by shirakun<br>· <a target="_blank" href="https://bugxia.com/710.html" rel="external nofollow noreferrer noopener">宝塔面板手动升级Nginx为1.15.3</a> by Bug 侠<br>· <a target="_blank" href="https://www.oschina.net/news/101630/nginx-security-issues" rel="external nofollow noreferrer noopener">nginx 安全问题致使 1400 多万台服务器易遭受 DoS 攻击</a>by hardbone<br>· <a target="_blank" href="https://cert.360.cn/warning/detail?id=7145d4cac6db4b7ca609990ad8a71f83" rel="external nofollow noreferrer noopener">Nginx HTTP/2和mp4模块拒绝服务预警</a> by 360-CERT<br>· <a target="_blank" href="https://www.oschina.net/news/101724/tengine-2-2-3-released" rel="external nofollow noreferrer noopener">Tengine-2.2.3 发布，修复 HTTP/2 和 MP4 模块安全 </a>by OSC_vYkLcq<br>· <a target="_blank" href="https://www.bt.cn/bbs/thread-11560-1-1.html" rel="external nofollow noreferrer noopener">宝塔更新建议为啥没人重视</a> by 宝塔官方团队<br>· <a target="_blank" href="https://yq.aliyun.com/articles/632491" rel="external nofollow noreferrer noopener">Tengine TLSv1.3最佳实践</a> by 金九<br>· <a target="_blank" href="https://www.bt.cn/bbs/thread-13422-1-1.html" rel="external nofollow noreferrer noopener">建议率先支持tls1.3协议</a> by laoda</p></blockquote><hr></div><br><div><div id="post-tag"><span><i class="iconfont icon-inbox"></i> <a class="hover-with-bg" href="/categories/%E7%A8%8B%E5%BA%8F">程序</a> &nbsp; </span><span><i class="iconfont icon-tag"></i> <a class="hover-with-bg" href="/tags/%E7%AC%94%E8%AE%B0">笔记</a></span></div><div id="post-note"><div><strong>本文作者：</strong><a href="/">七夏浅笑</a></div><div><strong>本文链接：</strong><a href="https://www.julydate.com/post/391521421/">https://www.julydate.com/post/391521421/</a></div><div><strong>版权声明：</strong>本站文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0/deed.zh" rel="nofollow noopener noopener">CC BY-NC-SA 3.0 CN</a> 协议进行许可</div></div><div id="post-nav" class="container"><div class="row"><a href="/post/3446765825/" id="post-nav-prev" class="col"><i class="fas fa-arrow-left"></i> <span class="post-nav-title">用过的服务器的 UNIX Bench</span> </a><a href="/post/1806566667/" id="post-nav-next" class="col"><span class="post-nav-title">博客搬迁啦</span> <i class="fas fa-arrow-right"></i></a></div></div></div></div><div class="col-lg-10 mx-auto nopadding-md"><div class="comments mx-auto" id="comments"><br><br><link rel="stylesheet" href="/lib/waline/2.15.6/waline.min.css"><style type="text/css">.wl-[data-class=wl-] .wl-content>p>a:not(.at){overflow-wrap:anywhere;display:inline}</style><div id="vcomments" style="margin:0 auto"></div><script defer src="/lib/waline/2.15.6/waline.min.js"></script><script>var notify=!1,verify=!1,oldLoad=window.onload;window.onload=function(){function e(e){const t=new FormData;return t.append("image",e),t.append("apiType","catbox"),t.append("token","146faa57355f01c8eed8a045eda6a684"),fetch("//www.hualigs.cn/api/upload",{method:"POST",mode:"cors",body:t}).then(e=>e.json()).then((function(e){const t=new RegExp("^[a-zA-z]+://[^s]*");let a=e.data.url.catbox;return t.test(a)?a:e.data.url[2]}))}Waline.init({el:"#vcomments",serverURL:"https://waline.julydate.com",meta:["nick","mail","link"],pageSize:"10",emoji:["https://www.julydate.com/waline-emojis/alus","https://www.julydate.com/waline-emojis/qq","https://www.julydate.com/waline-emojis/bilibili"],locale:{placeholder:"说点什么吧quq",uploading:"上传中...默认图床在境内可能无法访问"},imageUploader:function(t){return function(t){const a=new FormData;return a.append("smfile",t),a.append("format","json"),fetch("https://smms.xhtml.love/upload",{method:"POST",mode:"cors",headers:new Headers({Authorization:"FNnpntzeJnw1SQc61jL6Tt1UZPzmhLBT"}),body:a}).then(e=>e.json()).then((function(a){const n=new RegExp("^[a-zA-z]+://[^s]*");let o="image_repeated"==a.code?a.images:a.data.url?a.data.url:"";return n.test(o)?o:e(t)})).catch((function(a){return e(t)}))}(t)}}),oldLoad&&oldLoad()}</script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://waline.js.org" rel="nofollow noopener noopener">comments powered by Waline.</a></noscript></div></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container"><div id="toc"><p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p><div id="tocbot"></div></div></div></div></div></main><div id="sidebar" class="sidebar-hide"><span class="sidebar-button sidebar-button-shift" id="toggle-sidebar"><i class="fa fa-arrow-right on" aria-hidden="true"></i></span><div class="sidebar-overlay"></div><div class="sidebar-intrude"><div class="sidebar-avatar"><img src="//julydate-1251438221.file.myqcloud.com/img/head.jpg" srcset="//julydate-1251438221.file.myqcloud.com/img/head.jpg" alt="avatar"></div><div class="text-center sidebar-about"><p class="h3 sidebar-author">七夏浅笑</p><p class="sidebar-subtitle">七月之约，夏末浅笑<script type="text/javascript">console.log("博主认证: https://bbs.liyuans.com")</script></p><a href="https://github.com/julydate" class="h4" target="_blank"><i class="fab fa-github" aria-hidden="true"></i> </a>&nbsp;&nbsp; <a href="https://twitter.com/julydate" class="h4" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i> </a>&nbsp;&nbsp; <a href="https://live.bilibili.com/22628687" class="h4" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i> </a>&nbsp;&nbsp; <a href="mailto:i@xhtml.love" class="h4" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i> </a>&nbsp;&nbsp;</div><div class="sidebar-friend"><p class="h6 sidebar-friend-title"><span class="sidebar-label-left"><i class="fas fa-user-friends"></i></span> <span class="sidebar-label">友情链接</span></p><ul class="list-group"><a href="/links/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 其余友链在内页</li></a><a href="https://xiaopc.org/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; xiaopc</li></a><a href="https://webdoger.me/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 孔壕</li></a><a href="https://diygod.me/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; DIYgod</li></a><a href="https://www.chinuno.com/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 兔兔</li></a><a href="https://tea9.xyz/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 茶姐姐</li></a><a href="https://qianling.pw/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 千灵夙赋</li></a><a href="https://moegod.com/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 月宅</li></a><a href="https://www.xytsing.com/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 咸鱼滩音乐团队</li></a><a href="https://hitokoto.cn/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 一言</li></a><a href="https://blog.naixi.net/" target="_blank"><li class="list-group-item"><i class="fas fa-quote-left"></i>&nbsp; 奶昔</li></a></ul></div></div></div><a class="z-depth-1" id="scroll-top-button" href="#" role="button"><i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div id="footerContent" class="rgba-black-slight"><footer class="pt-5"><div class="text-center py-3"><div class="footer-theme"><a href="https://hexo.io" target="_blank" rel="nofollow noopener noreferrer">Hexo</a> theme <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener noreferrer">Fluid</a> mod by <a href="https://github.com/qixa/hexo-theme-fluid-mod" target="_blank" rel="nofollow noopener noreferrer">Julydate</a></div><div class="footer-copyright">©2026&nbsp;七夏浅笑 <i class="iconfont icon-love"></i> <span>萌萌哒<span id="runtime"></span>天啦</span></div><div class="footer-hitokoto"><a id="hitokotoa" href="#" target="_blank" rel="nofollow noopener noreferrer"><span id="hitokoto"></span></a></div></div></footer></div><script src="/lib/popper/popper.min.js"></script><script src="/lib/bootstrap/js/bootstrap.min.js"></script><script src="/lib/mdbootstrap/js/mdb.min.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script src="/lib/tocbot/tocbot.min.js"></script><script src="/js/post.js"></script><script src="/lib/prettify/prettify.min.js"></script><script type="text/javascript">$(document).ready((function(){$("pre").addClass("prettyprint  linenums"),prettyPrint()}))</script><script src="/lib/typed/typed.min.js"></script><script type="text/javascript">var typed=new Typed("#subtitle",{strings:["  ","CentOS宝塔面板Tengine手动升级到 v2.2.3 修复 HTTP/2 安全问题 并开启TLSv1.3&nbsp;"],cursorChar:"_",typeSpeed:70,loop:!1});typed.stop(),$(document).ready((function(){$(".typed-cursor").addClass("h2"),typed.start()}))</script><script src="/lib/anchor/anchor.min.js"></script><script type="text/javascript">anchors.options={placement:"right",visible:"hover"};var el="h1,h2,h3,h4,h5,h6".split(","),res=[];for(item of el)res.push(".markdown-body > "+item);anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script type="text/javascript">var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){getSearchFile(path),this.onclick=null}</script><script src="/lib/fancybox/jquery.fancybox.min.js"></script><script type="text/javascript">var setupFancybox=function(){$("#post img:not(.no-zoom img, img[no-zoom])").each((function(){var t=document.createElement("a");$(t).attr("data-fancybox","gallery"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)}))};setupFancybox()</script><script type="text/javascript">function hitokoto(o){$("#hitokoto").stop().fadeOut((function(){$("#hitokoto").html(o.hitokoto),document.getElementById("hitokotoa").href="https://hitokoto.cn/?uuid="+o.uuid,$("#hitokoto").stop().fadeIn()}))}function getHitokoto(){var o=["a","b","c","d","e","i"];fetch("https://v1.hitokoto.cn/?encode=json&charset=utf-8&c="+o[Math.floor(Math.random()*o.length)],{cache:"no-cache",method:"GET",mode:"cors"}).then(o=>o.json()).then(o=>{hitokoto(o),setTimeout(getHitokoto,1e4)}).catch(console.error)}$(document).ready((function(){getHitokoto()}))</script><script type="text/javascript">$("#background").removeClass("banner-bg"),$("body").addClass("banner-bg");var postToTopHight=$("#board").offset().top;$(window).scroll((function(){document.body.scrollTop+document.documentElement.scrollTop>=postToTopHight?($("#background").removeClass("rgba-black-slight"),$("#mainContent").removeClass("rgba-black-slight"),$("#footerContent").removeClass("rgba-black-slight")):($("#background").addClass("rgba-black-slight"),$("#mainContent").addClass("rgba-black-slight"),$("#footerContent").addClass("rgba-black-slight"))}))</script><script type="text/javascript">var blogRunTime=function(){var e=document.getElementById("runtime"),n=new Date("2015,04,20"),t=(new Date).getTime()-n.getTime(),i=Math.floor(t/864e5);e.innerHTML=i};$(document).ready((function(){blogRunTime()}))</script><script type="text/javascript">var originalTitle=document.title;window.onblur=function(){document.title="你不爱我了QAQ"},window.onfocus=function(){document.title=originalTitle}</script><script type="text/javascript">var jumpComments=function(){if(window.location.hash){var n=decodeURI(window.location.hash);if(!$(n).length)var o=setInterval((function(){$(n).length&&(clearInterval(o),setTimeout((function(){$("html, body").animate({scrollTop:$(n).offset().top-90},1e3)}),1500))}),100)}};$(document).ready((function(){jumpComments()}))</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-150991779-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-150991779-1")</script></body></html>